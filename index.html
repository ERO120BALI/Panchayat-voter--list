<!DOCTYPE html>
<html>
<head>
<title>Panchayat Voter List</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; background:#f4f6f9; padding:20px; }
h1 { text-align:center; }
input { width:100%; padding:10px; margin-bottom:15px; border-radius:6px; border:1px solid #ccc; }
.panchayat { background:#fff; padding:10px; margin:6px 0; border-radius:6px; cursor:pointer; }
.wards { margin-left:15px; margin-bottom:10px; display:none; }
.wards a { display:block; padding:5px; text-decoration:none; color:blue; }
</style>
</head>
<body>

<h1>Panchayat Voter List</h1>
<input type="text" id="search" placeholder="Search Panchayat..." onkeyup="filterList()">

<div id="panchayatList"></div>

<script>

const repo = "ERO120BALAJI";
const project = "Panchayat-voter-list";

fetch(`https://api.github.com/repos/${repo}/${project}/contents`)
.then(res => res.json())
.then(data => {
  const container = document.getElementById("panchayatList");

  data.forEach(folder => {
    if(folder.type === "dir") {

      const div = document.createElement("div");
      div.className = "panchayat";
      div.innerText = folder.name;
      div.onclick = () => loadWards(folder.name, div);

      const wardDiv = document.createElement("div");
      wardDiv.className = "wards";
      wardDiv.id = folder.name;

      container.appendChild(div);
      container.appendChild(wardDiv);
    }
  });
});

function loadWards(folderName, element) {
  const wardDiv = document.getElementById(folderName);

  if(wardDiv.innerHTML !== "") {
    wardDiv.style.display = wardDiv.style.display === "none" ? "block" : "none";
    return;
  }

  fetch(`https://api.github.com/repos/${repo}/${project}/contents/${folderName}`)
  .then(res => res.json())
  .then(files => {
    files.forEach(file => {
      if(file.name.endsWith(".pdf")) {
        const link = document.createElement("a");
        link.href = file.download_url;
        link.target = "_blank";
        link.innerText = file.name;
        wardDiv.appendChild(link);
      }
    });
    wardDiv.style.display = "block";
  });
}

function filterList() {
  let input = document.getElementById("search").value.toLowerCase();
  let items = document.getElementsByClassName("panchayat");
  for (let i = 0; i < items.length; i++) {
    if (items[i].innerText.toLowerCase().includes(input)) {
      items[i].style.display = "block";
    } else {
      items[i].style.display = "none";
    }
  }
}

</script>

</body>
</html>
